<!-- PAGE_TITLE: Armature system -->
<h1>
	Armature
</h1>

<p>
	The armature system is a subsystem of the rendering system. It handles all of the 3D model animations.
</p>

<p>
	In the source code it is found under the <code>Core::Render</code> namespace. Definitions are in the <code>armature.h</code> file.
</p>

<h3>
	Armatures
</h3>

<p>
	Armatures in the engine are what is called <a href="https://en.wikipedia.org/wiki/Skeletal_animation"><i>a skeleton</i></a> in other engines. An armature is a set of <i>bones</i>. These bones can change their translation, rotation and scale, and if a 3D model is bound to the armature, then it will deform together with these bones.
</p>

<h3>
	<a id="animations">Animations</a>
</h3>

<p>
	Animations are conventional 3D animations, consisting of keyframes, each of them is a record of the translation, rotation and scale of an armature at a given frame and they encode some kind of a motion.
	
	They are played back at 24 frames per second.
</p>

<h3>
	Creating animations
</h3>

<p>
	Animations are loaded from <code>.anim</code> files. These files can be created using the Blender Tram Animation Exporter tool.
</p>

<h3>
	Using animations
</h3>

<p>
	Animations can be loaded by creating an instance of a <code>Core::Render::Animation</code> class and calling their <code>LoadFromDisk()</code> method.
</p>

<div class="note-box">
	<h4>
		Note
	</h4>
	<p>
		Animation system as it is right now is broken:
		<ul>
			<li>
				When the 3D model deformation matrices are being calculated, the bone rotations are being processed in the wrong coordinate space, this is mostly because:
				<ul>
					<li>
						I forgot to put the bone roll in the armature definition in the model file formats.
					</li>
				</ul>
			</li>
			<li>
				There was something else, but I forgot.
			</li>
			<li>
				Animation data structure has sub-optimal memory layout.
			</li>
		</ul>
	</p>
</div>